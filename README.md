# ダビマス用配合簡単検索スクリプト  


## このスクリプトを作成した目的  
* 種牡馬や繁殖牝馬に対して、この馬とこの馬を掛け合わせれば見事な配合や完璧な配合になる、という検索に特化したものが欲しかった
* 自家製の馬を簡単に作成管理したかった
* オフラインでも検索したかった


## 必要なもの  
* PC。Windows以外で確認はしてないですが多分動くと思います。
* pythonのスクリプトを実行させる事が出来る環境。pythonバージョンは3.6で作成
* ネット環境は必須ではないが、最新データの更新時にダビマス全書からデータを取ってくるときに必要です
* スクリプトを実行させる事ができる程度のごく初歩的なpythonの知識


## 準備  
* python環境のセットアップは必須
* ネットで調べると親切な記事がいっぱいあります。
* 追加が必要なライブラリ
* データのスクレイピングにBeautifulSoupをつかっているので、pipで追加


## 注意  
* 当スクリプトはフリーソフトです。スクリプトの改良や他のプラットホームへの移植などはご自由に。特に著作権は主張しません。
* その際に発生した損害などへは一切責任を負いません。
* 当方は趣味プログラマーであり、pythonに特に精通しているわけではないので、個別の環境での不具合やpythonの使い方なんかを聞かれても返答に困ると思いますので、自己責任での使用をお願いします。
* ダビマス全書からデータを取得する際にスクレイピングを行っていますが、スクレイピングは使い方によっては相手のサーバに負担をかけてしまう行為です。スクリプトを改変したり、新規でデータを取りたいときなどは節度を守って利用しましょう。


## ファイルの説明  
README.md これ
derby_browser.py メインとなるスクリプト。配合検索時に使用
derby_scraper.py データ収集用のスクリプト。ダビマス全書が更新された時に実行。データベースにない馬を見つけてデータを追加します
derby_scraper_abi.py 非凡、才能のテキスト抽出用のスクリプト。新非凡なんかが登場したときに実行
deabymas.db sqlite形式のデータベース 直接いじることも可能です
ds_inb.csv インブリード効果を持つ馬の名前が入ったファイル。いじる必要はありません
ds_abi.csv 非凡、才能の効果を抜き出してテキスト化したもの。いじる必要はありません
dsconfig.py メインスクリプトから呼び出すスクリプト。いじる必要はありません


## 機能上の注意点  
1. 危険な配合に関しては完全放置です。自分の目で見て判断してください。
2. 重複するインブリードも普通に有用なインブリードとして検出します（サンデーサイレンスとhaloみたいなの
3. 年号付きの牡馬のインブリード検索がうまく働かない。例えばスペシャルウィーク1999とシーザリオで検索をかけた時などに、スペシャルウィークとスペシャルウィーク1999が別の馬として識別される
4. 自家製馬を削除する際は簡易的な物しか作ってないので、[DB Browser for SQLite](https://www.dbonline.jp/sqlite-db-browser/)などのデータベース編集ツールを使用しての削除を推奨
5. データベースの切り替えは実装していないので、サブ垢用などに複数のデータベースを管理したい場合は、DBをファイル名を変えて保存し、  
スクリプト実行時に
>python derby_browser.py othername.db  
  というかんじで読み込みたいファイル名を指定して実行してください。（derby_scraper.pyも同様
6. 組あわせて検索するときにレア度で検索対象を減らすことができますが、牝馬のレア度は
    5.名牝
    4.優
    3.良
    2.可
    1.無印
    となっています


## 使い方  
* IDEやコマンドラインから  >python derby_scraper.py  などでスクリプトを実行
大きく分けて3つのボタン**A-(BC)サーチ** **自家製メンテ** **A-(B-CD)サーチ**から呼び出される機能が使用可能です

### 基本操作

#### A-(BC)サーチ
左側上方の種牡馬リスト、または左側下方の繁殖牝馬リストから調べたい馬を選択状態にして、それぞれに近い方の[配合情報]ボタンを押すと、その馬と各種配合理論が成立する馬が検索表示されます。
[子供の情報]ボタンを押すと、上下両方のリストで選択中の馬同士で出来た牡馬、あるいは牝馬の検索を行います。

#### 自家製メンテ
種牡馬と牝馬をそれぞれのリストから選んで、[データ確認]ボタンを押すと、二頭から生まれる子供のデータが表示されます。  仮の名前が表示される欄があるので、そこへ名前を入力して、[牡馬として保存]か[牝馬として保存]ボタンを押すと、自家製馬としてデータベースに書き込まれます。  その後作った馬をリストに反映させるために、プルダウンメニューからリスト更新を実行してください  
名前の文字数や文字種に制限は設けていませんが、長すぎる馬名をつけると表示が乱れるので程々に。私は"ホニャララAB非素海"みたいな感じで使ってます
一時的に馬を作って配合を検索したいだけでデータベースに保存したくない時にはプルダウンメニューから[自家製馬をデータベースに登録しない]にチェックしておけばデータベースには保存されません。その馬はスクリプト終了まではリストに残ります
*自家製馬の削除について*
自家製馬の削除は、一応牡馬か牝馬のリスト上で右クリックすると別窓が開き、自家製馬のリストが表示され、そこから選択して削除ボタンを押すと削除はできますが、続けて削除できなかったり別窓が見えにくくなったりと、簡易でつけた物なので大変使いづらい代物です。なので上にも書きましたが別途データベースを管理するツールを使うことを推奨します。そのうちなんとかしたいとは思っていますが...

#### A-(B-CD)サーチ
1. 種牡馬かリストから選び[種牡馬決定]ボタンを押す
2. [母父をリストに表示] か [母母をリストに表示] を押す
3. 見事、または完璧になる可能性のある馬がリストに表示されるので[系統データ確認]ボタンを押すと、完璧か見事になる組み合わせ（CxD）の一覧が表示されます  この時[B-CDの配合も検索]にチェックが入っていると、そこで何らかの配合理論が成立しているかもチェックしますが、対象頭数が多いと時間がかかる場合があります

